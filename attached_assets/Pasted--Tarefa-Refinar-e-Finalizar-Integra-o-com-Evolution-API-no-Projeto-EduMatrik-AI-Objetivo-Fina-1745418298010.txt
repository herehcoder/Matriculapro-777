ğŸ”§ Tarefa: Refinar e Finalizar IntegraÃ§Ã£o com Evolution API no Projeto EduMatrik AI
ğŸ¯ Objetivo
Finalizar a integraÃ§Ã£o de WhatsApp com base na Evolution API, utilizando uma instÃ¢ncia individual por escola, porÃ©m com configuraÃ§Ã£o global da API feita exclusivamente pelo painel do administrador.

âš™ï¸ Detalhes TÃ©cnicos
ğŸ” Painel do Administrador
JÃ¡ existe uma seÃ§Ã£o â€œWhatsAppâ€ â€” ela deverÃ¡ ser refinada para conter os seguintes campos:

API_BASE_URL: URL base da Evolution API (ex: https://api.evolution-api.com)

API_KEY ou TOKEN_GERAL: token de autenticaÃ§Ã£o geral da API

WEBHOOK_URL_PADRAO: Webhook global (caso a API precise registrar um endpoint geral)

âš ï¸ Esses dados serÃ£o salvos em uma tabela especÃ­fica como whatsapp_api_config ou em settings.

Essa configuraÃ§Ã£o Ã© usada por todas as escolas, apenas como base para envio de mensagens.

ğŸ« Painel da Escola
Cada escola poderÃ¡ registrar e conectar sua prÃ³pria instÃ¢ncia do WhatsApp. Para isso:

Criar tela no dashboard da escola com:

Campo para ID da instÃ¢ncia

Campo para Token da instÃ¢ncia

Status da conexÃ£o (verificado via API da Evolution)

BotÃ£o para testar envio e recebimento de mensagem

BotÃ£o para â€œDesconectar WhatsAppâ€

Esses dados podem ser armazenados diretamente na tabela schools (campos: whatsapp_instance_id, whatsapp_instance_token) ou em uma tabela separada.

ğŸ“¤ Envio e Recebimento de Mensagens
Toda escola usarÃ¡ sua prÃ³pria instÃ¢ncia conectada (ID/token prÃ³prios).

O envio de mensagens, notificaÃ§Ãµes e mÃ­dias serÃ¡ feito com:

API base e token geral (vindo da config do admin)

ID e Token da instÃ¢ncia (vindo da escola)

As rotas e payloads seguirÃ£o a documentaÃ§Ã£o da Evolution API.

ğŸ“¥ Webhooks de Mensagens Recebidas
Cada instÃ¢ncia escolar usarÃ¡ um webhook prÃ³prio (/webhook/school/:id) para receber mensagens especÃ­ficas daquela escola.

As mensagens recebidas devem ser associadas Ã  instÃ¢ncia e Ã  escola correta.

ğŸ”„ ObservaÃ§Ãµes Adicionais
Apenas o painel administrador terÃ¡ acesso e controle sobre as configuraÃ§Ãµes da API em si.

Os outros painÃ©is (escolas) apenas consumirÃ£o suas instÃ¢ncias individuais.

Refinar a parte do painel â€œWhatsAppâ€ do admin, mantendo o layout existente e adaptando os campos conforme acima.